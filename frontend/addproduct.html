<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="assets/js/toast.js"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add Product | TeamAlpha</title>
    <!-- favicons Icons -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="assets/images/favicons/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="assets/images/favicons/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="assets/images/favicons/favicon-16x16.png"
    />
    <link rel="manifest" href="assets/images/favicons/site.webmanifest" />
    <meta name="description" content="mellis HTML 5 Template " />

    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />

    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <link
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap"
      rel="stylesheet"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Parisienne&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="assets/vendors/bootstrap/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/animate/animate.min.css" />
    <link rel="stylesheet" href="assets/vendors/animate/custom-animate.css" />
    <link rel="stylesheet" href="assets/vendors/fontawesome/css/all.min.css" />
    <link rel="stylesheet" href="assets/vendors/jarallax/jarallax.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/jquery-magnific-popup/jquery.magnific-popup.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/nouislider/nouislider.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/nouislider/nouislider.pips.css"
    />
    <link rel="stylesheet" href="assets/vendors/odometer/odometer.min.css" />
    <link rel="stylesheet" href="assets/vendors/swiper/swiper.min.css" />
    <link rel="stylesheet" href="assets/vendors/mellis-icons/style.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/tiny-slider/tiny-slider.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/reey-font/stylesheet.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/owl-carousel/owl.carousel.min.css"
    />
    <link
      rel="stylesheet"
      href="assets/vendors/owl-carousel/owl.theme.default.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/bxslider/jquery.bxslider.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/bootstrap-select/css/bootstrap-select.min.css"
    />
    <link rel="stylesheet" href="assets/vendors/vegas/vegas.min.css" />
    <link rel="stylesheet" href="assets/vendors/jquery-ui/jquery-ui.css" />
    <link rel="stylesheet" href="assets/vendors/timepicker/timePicker.css" />
    <link
      rel="stylesheet"
      href="assets/vendors/twenty-twenty/twentytwenty.css"
    />

    <!-- template styles -->
    <link rel="stylesheet" href="assets/css/mellis.css" />
    <link rel="stylesheet" href="assets/css/mellis-responsive.css" />
    <style>
      .add-product-section {
        padding: 100px 0;
        background: linear-gradient(135deg, #fcf5f5 0%, #fff 100%);
        min-height: 100vh;
        margin-top: 48px; /* Add space below navbar */
      }
      .add-product-container {
        width: 100%;
        max-width: 900px; /* Increased width */
        margin-left: auto;
        margin-right: auto;
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
        padding: 50px 40px;
        position: relative;
        box-sizing: border-box;
      }
      .add-product-title {
        font-family: "Poppins", sans-serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: #0f0f10;
        margin-bottom: 10px;
        text-align: center;
      }
      .add-product-subtitle {
        color: #89868d;
        font-size: 1.1rem;
        text-align: center;
        margin-bottom: 35px;
        font-family: "Inter", sans-serif;
      }
      .add-product-form label {
        font-weight: 600;
        color: #0f0f10;
        margin-bottom: 7px;
        font-size: 1rem;
        font-family: "Poppins", sans-serif;
      }
      .add-product-form input,
      .add-product-form textarea,
      .add-product-form select {
        border-radius: 10px;
        border: 1px solid #f0e8e8;
        background: #fcf5f5;
        padding: 14px 18px;
        font-size: 1rem;
        color: #333;
        margin-bottom: 18px;
        width: 100%;
        font-family: "Inter", sans-serif;
        transition: border-color 0.2s;
        box-sizing: border-box;
      }
      .add-product-form input:focus,
      .add-product-form textarea:focus,
      .add-product-form select:focus {
        border-color: #89868d;
        outline: none;
      }
      .add-product-form .form-row {
        display: flex;
        gap: 20px;
      }
      .add-product-form .form-row > div {
        flex: 1;
      }
      .add-product-form .ingredients-group {
        margin-bottom: 18px;
      }
      .add-product-form .ingredient-row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
      }
      .add-product-form .ingredient-row input {
        flex: 1;
        margin-bottom: 0;
      }
      .add-product-form .ingredient-row button {
        background: #89868d;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0 12px;
        font-size: 1.2rem;
        cursor: pointer;
        transition: background 0.2s;
      }
      .add-product-form .ingredient-row button:hover {
        background: #0f0f10;
      }
      .add-product-form .add-ingredient-btn {
        background: #fff;
        color: #89868d;
        border: 1px solid #89868d;
        border-radius: 8px;
        padding: 6px 18px;
        font-size: 1rem;
        font-weight: 600;
        margin-top: 5px;
        margin-bottom: 24px; /* Increased margin for spacing */
        cursor: pointer;
        transition: background 0.2s, color 0.2s;
        display: block; /* Ensure button is on its own line */
        width: auto;
      }
      /* Custom image upload styles */
      .custom-image-upload {
        border: 2px dashed #89868d;
        border-radius: 14px;
        background: #fcf5f5;
        padding: 32px 20px;
        text-align: center;
        margin-bottom: 18px;
        cursor: pointer;
        transition: border-color 0.2s;
        position: relative;
      }
      .custom-image-upload:hover {
        border-color: #0f0f10;
      }
      .custom-image-upload input[type="file"] {
        display: none;
      }
      .custom-image-upload .upload-icon {
        font-size: 2.5rem;
        color: #89868d;
        margin-bottom: 10px;
        display: block;
      }
      .custom-image-upload .upload-text {
        color: #0f0f10;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 4px;
      }
      .custom-image-upload .upload-hint {
        color: #89868d;
        font-size: 0.95rem;
      }
      .custom-image-upload .selected-images {
        margin-top: 12px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
      }
      .custom-image-upload .selected-images img {
        width: 48px;
        height: 48px;
        object-fit: cover;
        border-radius: 8px;
        border: 1px solid #eee;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      }
      .add-product-form .form-actions {
        text-align: center;
        margin-top: 30px;
      }
      .add-product-form .submit-btn {
        background: linear-gradient(90deg, #89868d, #0f0f10);
        color: #fff;
        border: none;
        border-radius: 50px;
        padding: 16px 50px;
        font-size: 1.1rem;
        font-weight: 700;
        letter-spacing: 0.1em;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        transition: background 0.2s, transform 0.2s;
        cursor: pointer;
      }
      .add-product-form .submit-btn:hover {
        background: #0f0f10;
        transform: translateY(-2px);
      }
      @media (max-width: 600px) {
        .add-product-container {
          padding: 30px 10px;
        }
        .add-product-title {
          font-size: 2rem;
        }
        .add-product-form .form-row {
          flex-direction: column;
          gap: 0;
        }
      }
      /* Add this for consistent logo sizing in navbar */
      .main-menu__logo img {
        max-height: 48px;
        width: auto;
        display: block;
      }
      /* Fix menu items and icons color */
      .main-menu__list > li > a,
      .main-menu__list > li > a:visited,
      .main-menu__list > li > a:active,
      .main-menu__list > li > a:focus {
        color: #fff !important;
      }
      .main-menu__list > li > a:hover {
        color: #ffb347 !important;
      }
      .main-menu__list .dropdown > a:after,
      .main-menu__list .dropdown > a:before {
        color: #fff !important;
      }
      .main-menu-two__search,
      .main-menu-two__cart,
      .main-menu-two__search-box a,
      .main-menu-two__cart-box a,
      .main-menu-two__search-box .icon-magnifying-glass,
      .main-menu-two__cart-box .icon-shopping-cart,
      .main-menu-two__search-box i,
      .main-menu-two__cart-box i {
        color: #fff !important;
      }
      .main-menu__list ul li a {
        color: #fff !important;
      }
      .main-menu__list ul li a:hover {
        color: #ffb347 !important;
      }
      .mobile-nav__toggler i {
        color: #fff !important;
      }
      /* Lighter navbar background and spacing below */
      .main-header-two,
      .main-menu.main-menu-two,
      .main-menu-two__wrapper,
      .stricky-header.stricked-menu.main-menu.main-menu-two,
      .sticky-header__content {
        background: #23232a !important; /* lighter than #18181c */
      }
      .main-header-two,
      .stricky-header.stricked-menu.main-menu.main-menu-two {
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
        margin-bottom: 32px; /* add space below navbar */
      }
      @media (max-width: 600px) {
        .main-header-two,
        .stricky-header.stricked-menu.main-menu.main-menu-two {
          margin-bottom: 20px;
        }
      }
      .main-menu-two__logout-box {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        height: 100%;
      }
      .main-menu-two__logout {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: linear-gradient(90deg, #89868d, #0f0f10);
        color: #fff !important;
        border: none;
        border-radius: 30px;
        padding: 10px 28px 10px 20px;
        font-size: 1rem;
        font-weight: 700;
        letter-spacing: 0.05em;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        transition: background 0.2s, transform 0.2s, box-shadow 0.2s;
        text-decoration: none;
        cursor: pointer;
        position: relative;
        outline: none;
      }
      .main-menu-two__logout i {
        font-size: 1.2em;
        margin-right: 6px;
        transition: color 0.2s;
      }
      .main-menu-two__logout:hover,
      .main-menu-two__logout:focus {
        background: #0f0f10;
        color: #ffb347 !important;
        transform: translateY(-2px) scale(1.04);
        box-shadow: 0 6px 24px rgba(0, 0, 0, 0.14);
        text-decoration: none;
      }
      .main-menu-two__logout:hover i,
      .main-menu-two__logout:focus i {
        color: #ffb347;
      }

      .main-menu__list > li.dropdown ul {
        background-color: #23232a !important;
      }
      .main-menu__list > li.dropdown ul li a {
        color: #fff !important;
        text-align: left;
      }
      .main-menu__list > li.dropdown ul li a:hover {
        color: #ffb347 !important;
      }
    </style>
  </head>
  <body>
    <!-- ======= Site Header/Navbar Start ======= -->

    <header class="main-header-two">
      <nav class="main-menu main-menu-two">
        <div class="main-menu-two__wrapper">
          <div class="main-menu-two__wrapper-inner">
            <div class="main-menu-two__left">
              <div class="main-menu-two__logo">
                <a href="index.html"
                  ><img src="assets/images/resources/logo-3.svg" alt=""
                /></a>
              </div>
            </div>
            <div class="main-menu-two__main-menu-box">
              <a href="#" class="mobile-nav__toggler"
                ><i class="fa fa-bars"></i
              ></a>
              <ul class="main-menu__list">
                <li>
                  <a href="dashboard.html">Dashboard</a>
                </li>
                <li>
                  <a href="orders.html">Orders</a>
                </li>
                <li class="dropdown">
                  <a href="#">Products</a>
                  <ul>
                    <li><a href="addproduct.html">Add Product</a></li>
                    <li><a href="manageproducts.html">Manage Products</a></li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a href="#">Blogs</a>
                  <ul>
                    <li><a href="addblog.html">Add Blog</a></li>
                    <li><a href="manageblogs.html">Manage Blogs</a></li>
                  </ul>
                </li>
              </ul>
            </div>
            <div class="main-menu-two__right">
              <div class="main-menu-two__logout-box">
                <a
                  href="logout.html"
                  class="main-menu-two__logout"
                  title="Logout"
                >
                  <i class="fas fa-sign-out-alt"></i>
                  Logout
                </a>
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <div class="stricky-header stricked-menu main-menu main-menu-two">
      <div class="sticky-header__content"></div>
      <!-- /.sticky-header__content -->
    </div>
    <!-- ======= Site Header/Navbar End ======= -->

    <div class="add-product-section">
      <div class="add-product-container">
        <div class="add-product-title">Add New Product</div>
        <div class="add-product-subtitle">
          Fill in the details below to add a new product to your store.
        </div>
        <form
          class="add-product-form"
          id="addProductForm"
          enctype="multipart/form-data"
          autocomplete="off"
        >
          <label for="name">Product Name *</label>
          <input
            type="text"
            id="name"
            name="name"
            required
            placeholder="Enter product name"
          />

          <label for="description">Description *</label>
          <textarea
            id="description"
            name="description"
            rows="3"
            required
            placeholder="Describe the product"
          ></textarea>

          <div class="form-row">
            <div>
              <label for="price">Price (USD) *</label>
              <input
                type="number"
                id="price"
                name="price"
                min="0"
                step="0.01"
                required
                placeholder="e.g. 19.99"
              />
            </div>
            <div>
              <label for="stockQuantity">Stock Quantity *</label>
              <input
                type="number"
                id="stockQuantity"
                name="stockQuantity"
                min="0"
                required
                placeholder="e.g. 100"
              />
            </div>
          </div>

          <div class="form-row">
            <div>
              <label for="category">Category *</label>
              <input
                type="text"
                id="category"
                name="category"
                required
                placeholder="e.g. Skincare"
              />
            </div>
            <div>
              <label for="servingSize">Serving Size *</label>
              <input
                type="text"
                id="servingSize"
                name="servingSize"
                required
                placeholder="e.g. 50ml"
              />
            </div>
          </div>

          <label for="howToUse">How to Use</label>
          <textarea
            id="howToUse"
            name="howToUse"
            rows="2"
            placeholder="Instructions for use"
          ></textarea>

          <label>Ingredients *</label>
          <div class="ingredients-group" id="ingredientsGroup">
            <div class="ingredient-row">
              <input
                type="text"
                name="ingredientName[]"
                placeholder="Ingredient name"
                required
              />
              <input
                type="text"
                name="ingredientQuantity[]"
                placeholder="Quantity (e.g. 10mg)"
                required
              />
              <button type="button" class="remove-ingredient" title="Remove">
                &times;
              </button>
            </div>
          </div>
          <button
            type="button"
            class="add-ingredient-btn"
            id="addIngredientBtn"
          >
            + Add Ingredient
          </button>

          <label for="images">Product Images *</label>
          <div class="custom-image-upload" id="customImageUpload">
            <span class="upload-icon"
              ><i class="fas fa-cloud-upload-alt"></i
            ></span>
            <span class="upload-text">Click or drag images here to upload</span>
            <span class="upload-hint"
              >You can select multiple images (JPG, PNG, etc.)</span
            >
            <input
              type="file"
              id="images"
              name="images"
              accept="image/*"
              multiple
              required
            />
            <div class="selected-images" id="selectedImages"></div>
          </div>

          <div class="form-actions">
            <button type="submit" class="submit-btn">Add Product</button>
          </div>
        </form>
      </div>
    </div>
    <script>
      // Ingredient dynamic add/remove
      document
        .getElementById("addIngredientBtn")
        .addEventListener("click", function () {
          const group = document.getElementById("ingredientsGroup");
          const row = document.createElement("div");
          row.className = "ingredient-row";
          row.innerHTML = `
        <input type="text" name="ingredientName[]" placeholder="Ingredient name" required />
        <input type="text" name="ingredientQuantity[]" placeholder="Quantity (e.g. 10mg)" required />
        <button type="button" class="remove-ingredient" title="Remove">&times;</button>
      `;
          group.appendChild(row);
        });
      document
        .getElementById("ingredientsGroup")
        .addEventListener("click", function (e) {
          if (e.target.classList.contains("remove-ingredient")) {
            const rows = document.querySelectorAll(".ingredient-row");
            if (rows.length > 1) e.target.parentElement.remove();
          }
        });

      // Custom image upload preview
      const customUpload = document.getElementById("customImageUpload");
      const fileInput = document.getElementById("images");
      const selectedImages = document.getElementById("selectedImages");

      customUpload.addEventListener("click", function (e) {
        if (e.target !== fileInput) fileInput.click();
      });

      customUpload.addEventListener("dragover", function (e) {
        e.preventDefault();
        customUpload.style.borderColor = "#0f0f10";
      });
      customUpload.addEventListener("dragleave", function (e) {
        e.preventDefault();
        customUpload.style.borderColor = "#89868d";
      });
      customUpload.addEventListener("drop", function (e) {
        e.preventDefault();
        customUpload.style.borderColor = "#89868d";
        fileInput.files = e.dataTransfer.files;
        showSelectedImages();
      });

      fileInput.addEventListener("change", showSelectedImages);

      function showSelectedImages() {
        selectedImages.innerHTML = "";
        const files = fileInput.files;
        if (!files.length) return;
        Array.from(files).forEach((file) => {
          if (file.type.startsWith("image/")) {
            const reader = new FileReader();
            reader.onload = function (e) {
              const img = document.createElement("img");
              img.src = e.target.result;
              selectedImages.appendChild(img);
            };
            reader.readAsDataURL(file);
          }
        });
      }

      // Form submit handler
      document
        .getElementById("addProductForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const form = e.target;
          const formData = new FormData(form);

          // Gather ingredients as array of objects
          const ingredientNames = formData.getAll("ingredientName[]");
          const ingredientQuantities = formData.getAll("ingredientQuantity[]");
          formData.delete("ingredientName[]");
          formData.delete("ingredientQuantity[]");
          const ingredients = [];
          for (let i = 0; i < ingredientNames.length; i++) {
            if (ingredientNames[i] && ingredientQuantities[i]) {
              ingredients.push({
                name: ingredientNames[i],
                quantity: ingredientQuantities[i],
              });
            }
          }
          formData.append("ingredients", JSON.stringify(ingredients));

          // Send request
          try {
            const response = await fetch(
              "https://dermaveritas.com/api/products/addproduct",
              {
                method: "POST",
                body: formData,
              }
            );
            const data = await response.json();
            if (response.ok) {
              toast.success("Product added successfully!");
              form.reset();
              selectedImages.innerHTML = "";
            } else {
              toast.error(data.message || "Failed to add product.");
            }
          } catch (err) {
            toast.error("Error: " + err.message);
          }
        });

      // Admin logout handler
      document.addEventListener("DOMContentLoaded", function () {
        const logoutBtn = document.querySelector(".main-menu-two__logout");
        if (logoutBtn) {
          logoutBtn.addEventListener("click", async function (e) {
            e.preventDefault();

            try {
              const response = await fetch(
                "https://dermaveritas.com/api/users/admin-logout",
                {
                  method: "GET",
                  credentials: "include",
                }
              );

              if (response.ok) {
                toast.success("Logged out successfully!");
                window.location.href = "index.html";
              } else {
                const data = await response.json();
                toast.error(data.message || "Failed to logout.");
              }
            } catch (error) {
              console.error("Logout error:", error);
              toast.error("Error during logout. Please try again.");
            }
          });
        }
      });
    </script>
    <script src="assets/vendors/jquery/jquery-3.6.0.min.js"></script>
    <script src="assets/vendors/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendors/jarallax/jarallax.min.js"></script>
    <script src="assets/vendors/jquery-ajaxchimp/jquery.ajaxchimp.min.js"></script>
    <script src="assets/vendors/jquery-appear/jquery.appear.min.js"></script>
    <script src="assets/vendors/jquery-circle-progress/jquery.circle-progress.min.js"></script>
    <script src="assets/vendors/jquery-magnific-popup/jquery.magnific-popup.min.js"></script>
    <script src="assets/vendors/jquery-validate/jquery.validate.min.js"></script>
    <script src="assets/vendors/nouislider/nouislider.min.js"></script>
    <script src="assets/vendors/odometer/odometer.min.js"></script>
    <script src="assets/vendors/swiper/swiper.min.js"></script>
    <script src="assets/vendors/tiny-slider/tiny-slider.min.js"></script>
    <script src="assets/vendors/wnumb/wNumb.min.js"></script>
    <script src="assets/vendors/wow/wow.js"></script>
    <script src="assets/vendors/isotope/isotope.js"></script>
    <script src="assets/vendors/countdown/countdown.min.js"></script>
    <script src="assets/vendors/owl-carousel/owl.carousel.min.js"></script>
    <script src="assets/vendors/bxslider/jquery.bxslider.min.js"></script>
    <script src="assets/vendors/bootstrap-select/js/bootstrap-select.min.js"></script>
    <script src="assets/vendors/vegas/vegas.min.js"></script>
    <script src="assets/vendors/jquery-ui/jquery-ui.js"></script>
    <script src="assets/vendors/timepicker/timePicker.js"></script>
    <script src="assets/vendors/circleType/jquery.circleType.js"></script>
    <script src="assets/vendors/circleType/jquery.lettering.min.js"></script>
    <script src="assets/vendors/sidebar-content/jquery-sidebar-content.js"></script>
    <script src="assets/vendors/twenty-twenty/twentytwenty.js"></script>
    <script src="assets/vendors/twenty-twenty/jquery.event.move.js"></script>
    <script src="assets/js/auth.js"></script>
    <!-- template js -->
    <script src="assets/js//mellis.js"></script>
  </body>
</html>
